def rev_b(out,p2):
    return out - p2

def b(p1,p2):
    return p1+p2

def rev_c(out,p2):
    return out + p2

def c(p1,p2):
    return p1-p2

def rev_d(out,p2):
    return out//p2

def d(p1,p2):
    return p1*p2

def rev_e(out, p2):
    return out ^ p2

def e(p1,p2):
    return p1^p2

def rev_f(out,p2):
    return out << (p2 + p2//3 * -3 & 0x1F)

def f(p1,p2):
    return p1 >> (p2 + p2//3 * -3 & 0x1F)

def rev_a(out,p2):
    return out >> (p2 + p2//3 * -3 & 0x1F)

def a(p1,p2):
    return p1 << (p2 + p2//3 * -3 & 0x1F)

def decrypt(out): 
    in_user = []
    for i in range(len(out)):
        if i%6 == 0:
            in_user.append(chr(rev_a(out[i], i+1)))
            #in_user.append('*')
        elif i%6 == 1:
            in_user.append(chr(rev_b(out[i], i+1)))
        elif i%6 == 2:
            in_user.append(chr(rev_c(out[i], i+1)))
        elif i%6 == 3:
            in_user.append(chr(rev_d(out[i], i+1)))
        elif i%6 == 4:
            in_user.append(chr(rev_e(out[i], i+1)))
        elif i%6 == 5:
            in_user.append(chr(rev_f(out[i], i+1)))
            #in_user.append('*')
    return in_user

def crypt(out): 
    in_user = []
    for i in range(len(out)):
        if i%6 == 0:
            in_user.append((a(out[i], i+1)))
            #in_user.append('*')
        elif i%6 == 1:
            in_user.append((b(out[i], i+1)))
        elif i%6 == 2:
            in_user.append((c(out[i], i+1)))
        elif i%6 == 3:
            in_user.append((d(out[i], i+1)))
        elif i%6 == 4:
            in_user.append((e(out[i], i+1)))
        elif i%6 == 5:
            in_user.append((f(out[i], i+1)))
            #in_user.append('*')
    return in_user

message = [0xe6,0x6a,0x62,0x1b0,0x69,99,0xe8,0x6e,0x72,0x212,99,0x31,0xcc,0x82,0x50,0x6e0,0x4e,0x72,0x66,0x8a,0x4a,0x478,0x7b,0x6c,0xbe,0x7b,0x39,0xa64,0x2d,0x6e,0x86,0x85,0x5c]

print(''.join(decrypt(message)))

message = "HackUTTT{5h1ft_n_r3v_4ll_aT_0nCe}"
a = crypt([ord(x) for x in message])
o = open('out','wb')
for i in a:
    o.write(i.to_bytes(1,'little'))
print(''.join(decrypt(a)))